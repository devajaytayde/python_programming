#Declaring global variable 
strExecution = ""
iColExecuted = 2
iStepCounter = 0
strTestCasesSep = ','
strExecutionStatusValue = input("What is Latest Execution Status to update in Test Case file: ")

#1. Read Test Case file from local folder and print
print("*"*20, "Original File before update", "*"*20)
with open("tc_keyword.csv","r") as file:
  for line in file:
    print(line.strip())

#Below is the output of the 1st program
#TC_ID,TC_Name,Executed,TestSteps,Keyword,ObjectName,ObjectType,Value
#1,Open Google Page,N,Step1,OpenBrowser,,www.google.com
#,,N,Step2,Enter search keyword,txt_search,Atyeti
#,,N,Step3,Click on Text,link_text,Welcome to Atyeti
#,,N,Step3,Click on Text,link_text,Welcome to Atyeti
#,,N,Step4,Close Browser,,

#2. Reading Test case file
with open("tc_keyword.csv","r") as file:
  for line in file:
    if line != '\n':            
      # Convert Change list value of "Executed" column to "Y" and store in local String variable again   
      lst = line.strip().split(",")
      iStepCounter = iStepCounter + 1
      if iStepCounter > 1:
        lst[iColExecuted] = strExecutionStatusValue
      if strExecution == '':
        strExecution = strTestCasesSep.join(lst)
      else:
        strExecution = strExecution + '\n' + strTestCasesSep.join(lst)

#3.Erasing older file content and Writing the updated Test Cases back to original file
with open("tc_keyword.csv","w") as file2:
  file2.writelines(strExecution)



#4. Read Test Case file from local folder and print
print("\n**********Updated File after Execution status update**********")
with open("tc_keyword.csv","r") as file:
  for line in file:
    print(line.strip())
